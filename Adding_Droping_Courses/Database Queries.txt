CREATE TABLE students (
    id INT AUTO_INCREMENT PRIMARY KEY,
    surname VARCHAR(100),
    given_name VARCHAR(100),
    student_id VARCHAR(50) UNIQUE,
    date_of_birth DATE,
    email VARCHAR(100),
    contact_number VARCHAR(15),
    father_name VARCHAR(100),
    mother_name VARCHAR(100),
    program ENUM('CSE', 'EEE', 'IPE'),
    session ENUM('Spring', 'Fall', 'Summer'),
    password VARCHAR(255),
    photo VARCHAR(255)
);

CREATE TABLE faculty (
    id INT AUTO_INCREMENT PRIMARY KEY,
    surname VARCHAR(100),
    given_name VARCHAR(100),
    faculty_id VARCHAR(50) UNIQUE,
    date_of_birth DATE,
    contact_number VARCHAR(15),
    father_name VARCHAR(100),
    mother_name VARCHAR(100),
    department ENUM('CSE', 'EEE', 'IPE'),
    password VARCHAR(255),
    photo VARCHAR(255)
);

CREATE TABLE admins (
    id INT AUTO_INCREMENT PRIMARY KEY,
    surname VARCHAR(100),
    given_name VARCHAR(100),
    faculty_id VARCHAR(50) UNIQUE,
    date_of_birth DATE,
    contact_number VARCHAR(15),
    father_name VARCHAR(100),
    mother_name VARCHAR(100),
    department ENUM('CSE', 'EEE', 'IPE'),
    password VARCHAR(255),
    photo VARCHAR(255)
);

CREATE TABLE courses (
    id INT AUTO_INCREMENT PRIMARY KEY,
    course_name VARCHAR(100),
    course_code VARCHAR(20) UNIQUE,
    created_by INT, -- Admin ID
    FOREIGN KEY (created_by) REFERENCES admins(id) ON DELETE CASCADE
);

CREATE TABLE sections (
    id INT AUTO_INCREMENT PRIMARY KEY,
    course_id INT NOT NULL,
    faculty_id INT NOT NULL,
    section_number INT NOT NULL,
    student_limit INT DEFAULT 10,
    FOREIGN KEY (course_id) REFERENCES courses(id) ON DELETE CASCADE,
    FOREIGN KEY (faculty_id) REFERENCES faculty(id) ON DELETE CASCADE
);

CREATE TABLE students_sections (
    student_id INT NOT NULL,
    section_id INT NOT NULL,
    PRIMARY KEY (student_id, section_id),
    FOREIGN KEY (student_id) REFERENCES students(id) ON DELETE CASCADE,
    FOREIGN KEY (section_id) REFERENCES sections(id) ON DELETE CASCADE
);

CREATE TABLE drop_applications (
    id INT AUTO_INCREMENT PRIMARY KEY,
    student_id INT NOT NULL,
    section_id INT NOT NULL,
    status ENUM('pending', 'approved_by_faculty', 'approved_by_admin', 'rejected') DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (student_id) REFERENCES students(id) ON DELETE CASCADE,
    FOREIGN KEY (section_id) REFERENCES sections(id) ON DELETE CASCADE
);

CREATE TABLE credentials (
    id INT AUTO_INCREMENT PRIMARY KEY,
    login_id VARCHAR(20) NOT NULL,
    role ENUM('student', 'faculty', 'admin') NOT NULL,
    password VARCHAR(255) NOT NULL,
    FOREIGN KEY (login_id) REFERENCES students(student_id) ON DELETE CASCADE,
    FOREIGN KEY (login_id) REFERENCES faculty(faculty_id) ON DELETE CASCADE,
    FOREIGN KEY (login_id) REFERENCES admins(faculty_id) ON DELETE CASCADE
);
